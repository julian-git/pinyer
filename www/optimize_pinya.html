<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Pinyer - Optimize pinya</title>
  <link rel="stylesheet" href="css/jquery-ui.css">
  <link rel="stylesheet" href="css/pinyer.css">
  <script src="js/jquery.min.js"></script>
  <!--script src="js/jquery-ui.min.js"></script-->
  <script type="text/javascript" src="js/jquery.svg/jquery.svg.js"></script>
  <script type="text/javascript" src="js/jquery.svg/jquery.svgdom.js"></script>
  <style>
    cast {
    margin: 0px 0px 0px 0px; padding: 0px; width: 0px; height: 0px;
    }
  </style>
  <script>
    errfunc = function(XMLHttpRequest, textStatus, errorThrown) {
      console.log('An error "' + errorThrown + '", status "' + textStatus + '" occurred during loading data: ' + XMLHttpRequest);
    }
    MakeRelationsInvisible = function(svg) {
       $("path.rel", svg.root()).addClass("invisible");
       $("text.rel", svg.root()).addClass("invisible");
    }

    $(function() {
    $('#pinya_wrap').css('width', '30cm');
    $('#pinya_wrap').css('height', '20cm');
    $('#pinya_wrap').svg({
      loadURL: "http://localhost/pinyer/info.py?what=solved_pinya&castell_id_name=cvg.3de9f",
      onLoad: MakeRelationsInvisible
    });

    $.ajax({
    url: "http://localhost/pinyer/info.py?what=rel_types&castell_id_name=cvg.3de9f",
    dataType: 'json',

    success: function(rels) {
      var svg = $('#pinya_wrap').svg('get');
      for (var rel in rels) {
        var label_id = 'chk_' + rel;
        $('<input/>', document).attr({
           'type'   : 'checkbox',
           'id'     : label_id
        })
        .text(rel)
        .appendTo('#control_wrap').click(function() {
	   $('.' + $(this).text(), svg.root()).toggleClass("invisible");
/*	   $('.' + $(this).text(), document).toggleClass("invisible");*/
        });
        $('<label/>', document).attr({ 
           'for'    : label_id,
           'class'  : 'lab' + rel
        })
        .text(rel)
        .appendTo('#control_wrap');
        $('<div/>', document).attr({
           'class': rel + "invisible inequality"
        })
        .text(rels[rel])
        .appendTo('#control_wrap');
        $('<br/>').appendTo('#control_wrap');
      }
    },
    
    error: errfunc
    });
    
    });

  </script>
</head>
<body>
  <div id="control_wrap" style="display:block; position:absolute">
  </div>
  <div id="pinya_wrap">
  </div>
</body>
</html>
